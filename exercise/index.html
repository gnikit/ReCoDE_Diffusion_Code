
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.9">
    
    
      
        <title>Exercises - ReCoDE Diffusion Code</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#546d78">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue-grey" data-md-color-accent="green">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#exercises" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ReCoDE Diffusion Code" class="md-header__button md-logo" aria-label="ReCoDE Diffusion Code" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ReCoDE Diffusion Code
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Exercises
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ReCoDE Diffusion Code" class="md-nav__button md-logo" aria-label="ReCoDE Diffusion Code" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ReCoDE Diffusion Code
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../1-numerics/" class="md-nav__link">
        1 - Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../2-oop/" class="md-nav__link">
        2 - Object-Oriented Programming
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../3-compile-basics/" class="md-nav__link">
        3 - Compilation Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../4-io/" class="md-nav__link">
        4 - File I/O Operations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../5-visualisation/" class="md-nav__link">
        5 - Data Visualisation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../6-sparse-storage/" class="md-nav__link">
        6 - Optimised data storage
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../7-ext-libs/" class="md-nav__link">
        7 - Using External Libraries
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../8-build-tools/" class="md-nav__link">
        8 - Build Tools
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../appendix/" class="md-nav__link">
        Appendix A - Theory
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Exercises
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Exercises
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#exercise-1a" class="md-nav__link">
    Exercise 1a
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-1b" class="md-nav__link">
    Exercise 1b
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-1c" class="md-nav__link">
    Exercise 1c
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-2a" class="md-nav__link">
    Exercise 2a
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-2b" class="md-nav__link">
    Exercise 2b
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-3a" class="md-nav__link">
    Exercise 3a
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-3b" class="md-nav__link">
    Exercise 3b
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#possible-extension-exercise" class="md-nav__link">
    Possible Extension Exercise
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#exercise-1a" class="md-nav__link">
    Exercise 1a
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-1b" class="md-nav__link">
    Exercise 1b
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-1c" class="md-nav__link">
    Exercise 1c
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-2a" class="md-nav__link">
    Exercise 2a
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-2b" class="md-nav__link">
    Exercise 2b
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-3a" class="md-nav__link">
    Exercise 3a
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-3b" class="md-nav__link">
    Exercise 3b
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#possible-extension-exercise" class="md-nav__link">
    Possible Extension Exercise
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

  



<h1 id="exercises">Exercises</h1>
<p>This section contains a number of suggested exercises that will give the user a deeper understanding of the topics covered in the above descriptions and utilised throughout this code. The exercises will increase progressively in complexity, with jumps in challenge roughly seperated by the numeric ID of the exercise.</p>
<p>Solutions to the exercises can be found in the 'solutions' directory, where a version of the main code exists, modified such that it solves the problem. Where possible, changes made to the main code have been appropriately commented with a double dollar symbol such that users can more readily find these modifications. For example, changes made for exercise 1a can be found by searching for '$$ Exercise 1a' within the appropriate solution directory.</p>
<h2 id="exercise-1a">Exercise 1a</h2>
<p><strong>Task:</strong> Add a print statement to the <strong>SetName</strong> Subroutine in the Materials Module</p>
<p><strong>Aims:</strong></p>
<ul>
<li>Gain an initial understanding of how a code can utilise an OOP structure</li>
</ul>
<p>For this exercise, add a print (or write) statement to the <strong>SetName</strong> Subroutine contained within the Materials Module, which prints the name of the material being set to the terminal.</p>
<h2 id="exercise-1b">Exercise 1b</h2>
<p><strong>Task:</strong> Write a new subroutine which prints all material data stored in the module</p>
<p><strong>Aims:</strong></p>
<ul>
<li>Develop an understanding of Object Orientation</li>
<li>Learn how to write a new subroutine and implement it in a class structure</li>
<li>Learn how to utilise a type to call the generated routine</li>
<li>Opportunity to gain experience with Fortran output formatting</li>
</ul>
<p>For this exercise, you must make your own subroutine within the Materials Module called <strong>PrintMaterial</strong>. This subroutine, when called from the Main, should print all material data contained within the materials class to the terminal. This is also a good opportunity for users to gain some experience with Fortran formatting if they wish, as this can make the terminal output much easier to read.</p>
<h2 id="exercise-1c">Exercise 1c</h2>
<p><strong>Task:</strong> Make a new material which can be used in the input deck</p>
<p><strong>Aims:</strong></p>
<ul>
<li>Experience with fortran logical arguments, namely <strong>If Statements</strong></li>
<li>Initial practice adjusting some exisitng logic within a subroutine</li>
</ul>
<p>For this exercise, a new material will be added to the list of those that the code can handle. The material 'Iron' will be added with an absoprtion cross section of <em>4.0</em> and source of <em>0.1</em>.</p>
<h2 id="exercise-2a">Exercise 2a</h2>
<p><strong>Task:</strong> Get input deck to instead explicitly read in material data rather than associating with a name</p>
<p><strong>Aims:</strong></p>
<ul>
<li>Experience making larger adjustments to the logic of the code</li>
<li>Understanding of how to adjust various sections of a code to handle a modification</li>
<li>Experience handling input files</li>
</ul>
<p>Currently, the code reads in a material name and then assigns material properties to the region based on a set of data stored in an If statement. For this exercise, the code will instead read in the absorption and source terms directly, such that 'Fuel' would instead become '1.0 6.0'. To achieve this, the user will need to adjust the <strong>Problem</strong> module, as well as adjust how they have defined their problem in the <strong>input.in</strong> file.</p>
<h2 id="exercise-2b">Exercise 2b</h2>
<p><strong>Task:</strong> Add another two sets of cell data to the .vtu file where the absorption and source material properties of each cell can be viewed</p>
<p><strong>Aims:</strong></p>
<ul>
<li>Gain experience writing data to an output file</li>
<li>Learn how to utilise vtu files to add data sets to ParaView</li>
</ul>
<p>The current vtu file output containts the Flux, Cell Number and Region Number data sets. In this exercise, the user will add the Source term data set to the vtu output, such that the source value of each cell can be viewed in ParaView. An additional Cell Data set will need to be added which uses the known Region Numbers to pull data from the <strong>Materials</strong> Module.</p>
<h2 id="exercise-3a">Exercise 3a</h2>
<p><strong>Task:</strong> Smear the problem into another dimension to produce a 3D ParaView output</p>
<p><strong>Aims:</strong></p>
<ul>
<li>Gain further experience writing data to an output file</li>
<li>Learn how to utilise vtu files to generate more complex outputs in ParaView</li>
</ul>
<p>The main version of the code already smears a 1-dimensional flux profile into a second dimension for the sake of a visualisation example. This could be furthered by also smearing the results in a third dimension. To do so, the user will need to make an additional set of nodes that have been translated in the z axis and ensure that these are then associated with the correct cells. Users should utilise the ParaView vtk format guide to do so, noting that they will now need to define the cells as a three dimensional shape. The vtk file format is described here: https://vtk.org/wp-content/uploads/2015/04/file-formats.pdf</p>
<h2 id="exercise-3b">Exercise 3b</h2>
<p><strong>Task:</strong> Create a Compressed Diagonal Storage Module and switch it out for the existing CRS Module</p>
<p><strong>Aims:</strong></p>
<ul>
<li>Gain an understanding of how to write a completely new module and incorporate it into the OOP structure</li>
<li>Gain experience with memory efficient programming</li>
<li>Gain experinece with abstract classes</li>
</ul>
<p>Currently the non-PETSc version of the code utilises a CRS system for handling the matrices involved in the problem. For this task, the user should create their own module which performs the same task utilising Compressed Diagonal Storage (CDS). The CDS module should have all the features of the CRS, allowing it to be used with the polymorphic matrix constructor and solver that already exists within the code. The user should ensure that they have added their CDS module to the makefile, and allocated it as 't_cds' where this has been done for 't_crs'. As a stretch goal, the user could also compare the solve times with their CDS module against that of the original CRS. An explanation of the CDS methodology can be found at: http://netlib.org/linalg/html_templates/node94.html</p>
<h2 id="possible-extension-exercise">Possible Extension Exercise</h2>
<p><strong>Task:</strong> Make a wrapper for the blas/lapack library and use instead of PETSc/CG</p>
<p><strong>Aims:</strong></p>
<ul>
<li>Gain experience installing external libraries</li>
<li>Understand how one can incorporate an external library into the code</li>
</ul>
<p>This extension exercise involves incorporating an additional external library into the code. BLAS and LAPACK are often used in professional codes as the utilise a number of highly optimised mathematical routines. To solve the problem, the user should utilise DGETRF and DGETRI to perform LU decomposition and inversion of the matrix, then multiply it by the source vector using DGEMV. The code can be installed easily on a linux OS with the commands:</p>
<div class="highlight"><pre><span></span><code>sudo apt-get install libblas-dev liblapack-dev
</code></pre></div>
<p>An explanation of how to use the code and each routine can be found at:
http://www.netlib.org/lapack/explore-html/</p>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../appendix/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Appendix A - Theory" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Appendix A - Theory
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.top"], "search": "../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
  </body>
</html>